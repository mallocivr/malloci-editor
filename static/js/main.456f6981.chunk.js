(this.webpackJsonpmallocivr=this.webpackJsonpmallocivr||[]).push([[0],{170:function(e,t,a){},214:function(e,t,a){},215:function(e,t,a){},251:function(e,t,a){e.exports=a(763)},256:function(e,t,a){},267:function(e,t,a){},428:function(e,t){},459:function(e,t,a){},763:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(5),i=a.n(l),c=(a(256),a(13)),o=a(107);a(265),a(266);o.initializeApp({apiKey:"AIzaSyCLN6m_UZpazTVvrX1vtFdyTEPx7wYaTyk",authDomain:"malloci-8f365.firebaseapp.com",databaseURL:"https://malloci-8f365.firebaseio.com",projectId:"malloci-8f365",storageBucket:"malloci-8f365.appspot.com",messagingSenderId:"126802496533",appId:"1:126802496533:web:614183fabd31d8510bd21c",measurementId:"G-BSBQC0NNQJ"});var s=o.storage(),u=o.firestore(),m=(a(267),a(39)),d=a(76),h=a(53),f=a(98),g=a.n(f),p=a(126),b={},E=a(175),x=a(774),v=a(770),y=a(767),w=[{title:"Markdown",className:"markdown",dataIndex:"markdown"},{title:"Rendered",className:"rendered",dataIndex:"rendered"}],k=[{key:"1",markdown:"# Museum Title\n## Section Title\n### Subsection Title\n...",rendered:"Create rooms in your museum."},{key:"3",markdown:"$[walls](img.jpg) \n$[ceiling](img.jpg) \n$[floor](img.jpg)",rendered:"set the textures of the walls, floor, or the ceiling"}],O=function(){return r.a.createElement("div",null,r.a.createElement(y.a,{id:"panelstyle",columns:w,dataSource:k,bordered:!0,pagination:!1}),r.a.createElement("p",{id:"panelstyle"},"While uploading and using image textures for the walls, ceiling and floor, it is recommended that you crop your textures so that the dimensions are powers of 2 for performance reasons."))},j=[{title:"Markdown",className:"markdown",dataIndex:"markdown"},{title:"Rendered",className:"rendered",dataIndex:"rendered"}],I=[{key:"1",markdown:"![caption text](img.jpg)",rendered:"\u200bThe image will be framed and hung on the wall in the exhibit"},{key:"2",markdown:"> Block quote\n\n> Multi line\n> block quote",rendered:"\u200bThis text will become a descriptive panel, adding context to your exhibit"},{key:"3",markdown:"![caption text](img.jpg) \n^(audio-file.m4a)",rendered:"This audio file will be attached to the image or blockquote on the line above it"},{key:"4",markdown:"~ \n![These artifacts](img.jpg) \n\n> Will be hidden\n> from the article\n> but will be visible\n> in the exhibit!\n~",rendered:"This image will be visible in the VR museum, but not in the document view"},{key:"5",markdown:'```\n// This code will be rendered\n// as text art\nvar s = "JavaScript syntax highlighting" \n alert(s);\n```',rendered:r.a.createElement("code",null,"// This code will be rendered",r.a.createElement("br",null),"// as text art",r.a.createElement("br",null),'var s = "JavaScript syntax highlighting"',r.a.createElement("br",null),"alert(s)")}],S=function(){return r.a.createElement("div",null,r.a.createElement(y.a,{id:"panelstyle",columns:j,dataSource:I,bordered:!0,pagination:!1}))},N=v.a.Panel,T=function(){return r.a.createElement("div",{className:"markdown-container"},r.a.createElement(v.a,{defaultActiveKey:[""]},r.a.createElement(N,{className:"syntax-guide",header:"Extended Markdown syntax guide",id:"headerstyle",key:"1"},r.a.createElement("p",null,"Creating and formatting rooms in the museum:"),r.a.createElement(O,null),r.a.createElement("p",null,"Populating the room with artifacts:"),r.a.createElement(S,null))))},A=a(229),C=a.n(A),M=(a(430),x.a.TextArea),D=E.a.TabPane;function B(e){console.log(e)}var _={display:"none"};var P=function(e){var t=Object(n.useState)(e.value),a=Object(c.a)(t,2),l=a[0],i=a[1];return Object(n.useEffect)((function(){i(e.value)}),[e.value]),r.a.createElement("div",{className:"card-container"},r.a.createElement(E.a,{onChange:B,type:"card"},r.a.createElement(D,{tab:"Markdown",key:"1"},r.a.createElement("div",{id:"editorheight"},r.a.createElement(T,null),r.a.createElement(C.a,{id:"editor3",label:"Markdown Editor",value:l,onChange:function(e){i(e)},options:{insertTexts:{horizontalRule:["","\n\n-----\n\n"],image:["\n\n![a caption describing your image](image-name",".jpg)\n\n"],link:["[","](http://)"],table:["","\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text      | Text     |\n\n"]}}}),r.a.createElement(M,{id:"editor",value:l,style:_})))))},R=a(777),U=a(773),V=a(768),F=a(27),q=a(778),W=["m4a","mp3","wav"],$={name:"file",multiple:!0,customRequest:function(e){var t=e.file,a=e.onError,n=e.onSuccess,r=Object(R.a)();(W.includes(t.name.split(".").pop())?s.ref("/audio/".concat(r+t.name)).put(t):s.ref("/images/".concat(r+t.name)).put(t)).on("state_changed",(function(e){console.log(e)}),(function(e){console.log(e),a(e,t)}),(function(e){W.includes(t.name.split(".").pop())?s.ref("audio").child(r+t.name).getDownloadURL().then((function(e){b[t.name]=e})):s.ref("images").child(r+t.name).getDownloadURL().then((function(e){b[t.name]=e})),n(e,t)}))},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?U.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&U.a.error("".concat(e.file.name," file upload failed."))}},H=function(){return r.a.createElement(V.a,$,r.a.createElement(F.a,null,r.a.createElement(q.a,null)," Upload"))},L=a(59),J=a(769),z=a(101),Y=a(45),G=a(772),K=function(e){var t=e.siteTitle;return r.a.createElement(G.a,{className:"site-page-header",title:t})};K.defaultProps={siteTitle:"Malloci"};var Q=K,X=a(779),Z=(a(459),function(e){var t=e.children;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{margin:"0 auto",padding:"0 1.0875rem 1.45rem"}},r.a.createElement("main",null,t),r.a.createElement("footer",null,"\xa9 ",(new Date).getFullYear(),", Built with mochi muffins.")))}),ee=a(137),te=a(138),ae=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(ee.a)(this,e),this.VSCode=t,this.debug=a,this.tree=null,this.cleanedMD=null}return Object(te.a)(e,[{key:"parseList",value:function(e){for(var t={rooms:[],theme:{floor:null,walls:null,ceiling:null,frames:null}},a={},n=[],r="",l="",i="",c="",o=!1,s=!1,u=e.split(","),m=0;m<u.length;m++){var d=u[m],h=d.split(" ");if("#"!==h[0].charAt(0)||o||(r=h.shift(),null!==a.name?(a.text=l,a.artifacts=n,l="",n=[],t.rooms.push(a),a={}):""!==l&&(t.text=l,t.artifact=n,l="",n=[]),"#"===r&&(t.name=h.join(" ")),a.name=h.join(" ")),">"!==h[0].charAt(0)||o?""!==i&&(n.push(this.parseArtifact(i,"block quote")),i=""):i+=h.join(" ").replace(">","").replace(/(^[\s]+|[\s]+$)/,"\n"),h[0].includes("```")&&!o?(c+=d+"\n",o=!0):o?(d.includes("```")&&(o=!1),c+=d+"\n"):""===c&&"`"===h[0].charAt(0)?(c+=d+"\n",n.push(this.parseArtifact(c,"code")),c=""):o||""===c||(n.push(this.parseArtifact(c,"code block")),c=""),"!"!==h[0].charAt(0)||o||n.push(this.parseArtifact(d,"image")),"$"===h[0].charAt(0)&&!o){var f=d.substring(d.lastIndexOf("[")+1,d.lastIndexOf("]")),g=d.substring(d.lastIndexOf("(")+1,d.lastIndexOf(")"));switch(f){default:break;case"floor":t.theme.floor=g;break;case"walls":t.theme.walls=g;break;case"ceiling":t.theme.ceiling=g;break;case"frames":t.theme.frames=g}u.splice(m,1),--m}"&"!==h[0].charAt(0)||o||(n.push(this.parseArtifact(d,"3D")),u.splice(m,1),--m),"^"!==h[0].charAt(0)||o||(this.addAudio(n,d),u.splice(m,1),--m),"~"!==h[0]||o||(s=!s),(s||"~"===h[0]&&!o)&&(u.splice(m,1),--m),this.debug&&console.log(n),l+=d+"\n"}return null!==a.name&&(a.text=l,a.artifacts=n,l="",n=[],t.rooms.push(a),a={}),this.tree=t,this.cleanedMD=u.join("\n"),this.tree}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("parsing");for(var a={rooms:[],theme:{floor:null,walls:null,ceiling:null,frames:null}},n={},r=[],l="",i="",c="",o="",s=!1,u=!1,m=e.split("\n"),d=0;d<m.length;d++){var h=m[d],f=h.split(" ");if("#"!==f[0].charAt(0)||s||(l=f.shift(),null!==n.name?(n.text=i,n.artifacts=r,i="",r=[],a.rooms.push(n),n={}):""!==i&&(a.text=i,a.artifact=r,i="",r=[]),"#"===l&&(a.name=f.join(" ")),n.name=f.join(" ")),">"!==f[0].charAt(0)||s?""!==c&&(r.push(this.parseArtifact(c,"block quote")),c=""):c+=f.join(" ").replace(">","").replace(/(^[\s]+|[\s]+$)/,"\n"),f[0].includes("```")&&!s?(o+=h+"\n",s=!0):s?(h.includes("```")&&(s=!1),o+=h+"\n"):""===o&&"`"===f[0].charAt(0)?(o+=h+"\n",r.push(this.parseArtifact(o,"code")),o=""):s||""===o||(r.push(this.parseArtifact(o,"code block")),o=""),"!"!==f[0].charAt(0)||s||(r.push(this.parseArtifact(h,"image",t)),t&&t[h.substring(h.lastIndexOf("(")+1,h.lastIndexOf(")"))]&&(m[d]=h.replace(h.substring(h.lastIndexOf("(")+1,h.lastIndexOf(")")),t[h.substring(h.lastIndexOf("(")+1,h.lastIndexOf(")"))]),h=m[d])),"$"===f[0].charAt(0)&&!s){var g=h.substring(h.lastIndexOf("[")+1,h.lastIndexOf("]")),p=h.substring(h.lastIndexOf("(")+1,h.lastIndexOf(")"));switch(p=t&&t[h.substring(h.lastIndexOf("(")+1,h.lastIndexOf(")"))]?t[h.substring(h.lastIndexOf("(")+1,h.lastIndexOf(")"))]:h.substring(h.lastIndexOf("(")+1,h.lastIndexOf(")")),this.VSCode&&!/^(?:\/|[a-z]+:\/\/)/.test(p)&&(p=this.VSCode+p),g){default:break;case"floor":a.theme.floor=p;break;case"walls":a.theme.walls=p;break;case"ceiling":a.theme.ceiling=p;break;case"frames":a.theme.frames=p}m.splice(d,1),--d}if("&"!==f[0].charAt(0)||s||(r.push(this.parseArtifact(h,"3D")),m.splice(d,1),--d),"^"===f[0].charAt(0)&&!s){var b=h.substring(h.lastIndexOf("[")+1,h.lastIndexOf("]"));h="frame"===b?this.addFrame(r,h,t):this.addAudio(r,h,t),m.splice(d,1),--d}"~"!==f[0]||s||(u=!u),(u||"~"===f[0]&&!s)&&(m.splice(d,1),--d),i+=h+"\n"}return null!==n.name&&(""!==c&&(r.push(this.parseArtifact(c,"block quote")),c=""),""!==o&&(r.push(this.parseArtifact(o,"code block")),o=""),n.text=i,n.artifacts=r,i="",r=[],a.rooms.push(n),n={}),this.tree=a,this.cleanedMD=m.join("\n"),this.tree}},{key:"parseArtifact",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n={};switch(n.type=t,n.audioSrc=null,n.frameSrc=null,t){default:break;case"image":a&&a[e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")"))]?n.src=a[e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")"))]:n.src=e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")),n.alt=e.substring(e.lastIndexOf("[")+1,e.lastIndexOf("]"));break;case"block quote":n.text=e;break;case"code":n.code=e.replace(/`/g,"").replace("\n","");break;case"code block":var r=e.replace(/`/g,"");n.lang=r.split("\n")[0],n.code=r.replace(n.lang+"\n","");break;case"3D":n.src=e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")),n.name=e.substring(e.lastIndexOf("[")+1,e.lastIndexOf("]"))}return this.VSCode&&n.src&&!/^(?:\/|[a-z]+:\/\/)/.test(n.src)&&(n.src=this.VSCode+n.src),n}},{key:"addAudio",value:function(e,t,a){return a&&a[t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))]?(e[e.length-1].audioSrc=a[t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))],t=t.replace(t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")),a[t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))])):e[e.length-1].audioSrc=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")),this.VSCode&&!/^(?:\/|[a-z]+:\/\/)/.test(e[e.length-1].audioSrc)&&(e[e.length-1].audioSrc=this.VSCode+e[e.length-1].audioSrc),t}},{key:"addFrame",value:function(e,t,a){return a&&a[t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))]?(e[e.length-1].frameSrc=a[t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))],t=t.replace(t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")),a[t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")"))])):e[e.length-1].frameSrc=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")),this.VSCode&&!/^(?:\/|[a-z]+:\/\/)/.test(e[e.length-1].frameSrc)&&(e[e.length-1].frameSrc=this.VSCode+e[e.length-1].frameSrc),t}}]),e}(),ne=a(57),re=a.n(ne),le=a(70),ie=a.n(le),ce=function(e){function t(e,a){return"string"===typeof a?e+a:r.a.Children.toArray(a.props.children).reduce(t,e)}return Object(n.useEffect)((function(){document.getElementById("doc-preview").querySelectorAll("pre code").forEach((function(e){ie.a.highlightBlock(e)}))}),[e.md]),r.a.createElement("div",{id:"doc-preview"},r.a.createElement(re.a,{source:e.md,renderers:{heading:function(e){var a=r.a.Children.toArray(e.children).reduce(t,"").toLowerCase().replace(/[!"#$%&'()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\W/g,"-");return r.a.createElement("h"+e.level,{id:a},e.children)}}}))},oe=a(100),se=function(e){var t=JSON.stringify(e.tree),a=null;return e.editor&&(a=r.a.createElement("a-cursor",null)),r.a.createElement(oe.Scene,{id:e.exhibitId,"vr-mode-ui":"enabled: false",embedded:!0,background:"color: #87ceeb"},r.a.createElement("a-assets",null,r.a.createElement("a-mixin",{id:"checkpoint"}),r.a.createElement("a-mixin",{id:"checkpoint-hovered",color:"#6CEEB5"}),r.a.createElement("img",{id:"wallTexture",src:"/textures/wall.jpg"}),r.a.createElement("img",{id:"floorTexture",src:"/textures/concrete_floor.jpg"}),r.a.createElement("img",{id:"ceilingTexture",src:"/textures/concrete_floor.jpg"}),r.a.createElement("img",{id:"frameTexture",src:"/textures/frame.jpg"})),r.a.createElement("a-light",{type:"ambient",position:"0 6 0",rotation:"0 0 45"}),r.a.createElement(oe.Entity,{id:"rig","movement-controls":{enabled:!0},position:"2 0 1",rotation:"0 180 0"},r.a.createElement("a-camera",{id:"camera","look-controls":"pointerLockEnabled: true"},r.a.createElement("a-sound",{id:"ambient-track",src:"src: url(/audio/light-piano-noodling-in-b.mp3)",autoplay:"false",volume:"0.4",loop:"true",position:"0 4 0"}),a),r.a.createElement(oe.Entity,{"laser-controls":{hand:"left"},raycaster:{objects:".clickable",far:3},"teleport-controls":{collisionEntities:".scenery",drawForAllCollisions:!1,landingMaxAngle:45,button:"trigger",cameraRig:"#rig",teleportOrigin:"#camera"}}),r.a.createElement(oe.Entity,{"laser-controls":{hand:"right"},raycaster:{objects:".clickable",far:3},"teleport-controls":{collisionEntities:".scenery",drawForAllCollisions:!1,landingMaxAngle:45,button:"trigger",cameraRig:"#rig",teleportOrigin:"#camera"}})),r.a.createElement(oe.Entity,{id:"museum",malloci:{tree:t,hallWidth:8,wallHeight:5,base64Mode:e.b64,debug:e.debug}}))},ue=(a(214),E.a.TabPane);function me(e){console.log(e)}var de=function(){var e=Object(d.g)().id,t=Object(n.useState)({theme:{floor:null,walls:null,ceiling:null},rooms:[{name:"1",artifacts:[]},{name:"2",artifacts:[]}]}),a=Object(c.a)(t,2),l=a[0],i=a[1],s=Object(n.useState)(""),m=Object(c.a)(s,2),h=m[0],f=m[1],x=Object(n.useState)("# Hello world! \n\n> Welcome to the world! \n\n## Hello continent \n\nThis is a starter exhibit. Hit build to view it in VR. The name of the museum is Hello world!. There is one room, Hello Continent. There's some wall art about baby elephants and a picture of a baby elephant in a bucket. \n\n> Baby elephants are endangered \n\n![baby elephants are endangered!](https://i.imgur.com/SnolApK.jpg)"),v=Object(c.a)(x,2),y=v[0],w=v[1],k=Object(n.useState)(""),O=Object(c.a)(k,2),j=O[0],I=O[1],S=Object(n.useState)(!1),N=Object(c.a)(S,2),T=N[0],A=N[1],C=Object(n.useState)(""),M=Object(c.a)(C,2),D=M[0],B=M[1],_=function(){var e=Object(p.a)(g.a.mark((function e(){var t,a,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ae,a=document.getElementById("editor"),n=t.parse(a.value,b),e.next=5,fetch("https://malloci.uc.r.appspot.com/generate",{method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{Accept:"application/json","Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(n)});case 5:if((r=e.sent).ok){e.next=11;break}console.error("bad response, loading user defined tree"),i(n),e.next=15;break;case 11:return e.next=13,r.json();case 13:n=e.sent,i(n);case 15:f(t.cleanedMD);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){if(e){var t=u.collection("exhibits").doc(e);t.get().then((function(e){e.exists?(o.auth().currentUser&&o.auth().currentUser.uid===e.data().authorID||B("/Exhibits/".concat(t.id)),console.log("success!!!!"),function(e){for(var t in e)b[t]=e[t];console.log(b)}(JSON.parse(e.data().fileDict)),I(!0),w(e.data().rawMD)):(console.log("No such document!"),B("/Exhibits/".concat(t.id)))})).catch((function(e){console.log("Error getting document:",e),B("/Exhibits/".concat(t.id))}))}_()}),[]);return r.a.createElement(Z,null,r.a.createElement(Q,{siteTitle:"Create a New Exhibit"}),r.a.createElement("div",{id:"alertstyle"}),r.a.createElement(z.a,null,r.a.createElement(Y.a,{classname:"gutter-col"},r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"A web editor to view museums written in markdown.",r.a.createElement("br",null),'Create your exhibit in the panel on the left; there\'s a guide detailing the markdown syntax you should use. View your exhibit space in the "Exhibit" tab of panel on the right. The "Document" tab will contain an article of your exhibit instead.',r.a.createElement("br",null),"The editor area in the \"Markdown\" panel contains basic buttons to help you with the markdown syntax. You can click on the H icon to add a header, the link icon to link images, the blockquote icon to add a quote, and so on. In the event that you're using images from the internet in your exhibit via links, make sure that you're using images which are marked for reuse (they'll be blocked by your browser and won't show up, otherwise).")))),r.a.createElement(z.a,null,r.a.createElement(Y.a,{className:"gutter-col",span:12},r.a.createElement("div",{className:"gutter-row",id:"exhibittext"},r.a.createElement(P,{value:y})),r.a.createElement("div",{className:"gutter-row"},r.a.createElement(F.a,{onClick:function(){_()},id:"build-exhibit",type:"primary"},"Build")),r.a.createElement("div",{className:"gutter-row",id:"imageupload"},r.a.createElement(H,null))),r.a.createElement(Y.a,{className:"gutter-col",span:12},r.a.createElement("div",{className:"gutter-row",id:"exhibitmaster"},r.a.createElement("div",{className:"card-container"},r.a.createElement(E.a,{onChange:me,type:"card"},r.a.createElement(ue,{id:"exhibit_pane",tab:"Exhibit",key:"1"},r.a.createElement(se,{exhibitId:"preview",tree:l,editor:!0,debug:!0})),r.a.createElement(ue,{tab:"Document",key:"2"},r.a.createElement(ce,{md:h}))))),r.a.createElement("div",{className:"gutter-row"},function(){if(j)return r.a.createElement("div",null,r.a.createElement(L.a,{title:"Delete This Exhibit"},r.a.createElement(F.a,{type:"danger",shape:"circle",onClick:function(){return A(!0)},icon:r.a.createElement(X.a,null)})),r.a.createElement(J.a,{title:"Basic Modal",visible:T,onOk:function(){u.collection("exhibits").doc(e).delete().then((function(){console.log("Document successfully deleted!"),B("/")})).catch((function(e){console.error("Error removing document: ",e)}))},onCancel:function(){return A(!1)},okText:"Yes, delete this Exhibit.",okButtonProps:{type:"danger"},cancelText:"Cancel"},r.a.createElement("p",null,"This will permanently delete your exhibit, Would you like to continue?")))}(),r.a.createElement(F.a,{onClick:function(){!function(){if(console.log(Object.keys(b)),e){var t=u.collection("exhibits").doc(e);t.update({preview:0!==Object.keys(b).length?b[Object.keys(b)[0]]:"img/Maria.jpg",title:l.name,rawMD:document.getElementById("editor").value,fileDict:JSON.stringify(b),md:h,tree:l}).then((function(){console.log("Document successfully updated!"),B("/Exhibits/".concat(t.id))})).catch((function(e){console.error("Error adding document: ",e)}))}else u.collection("exhibits").add({author:o.auth().currentUser.displayName,authorID:o.auth().currentUser.uid,preview:0!==Object.keys(b).length?b[Object.keys(b)[0]]:"img/Maria.jpg",title:l.name,rawMD:document.getElementById("editor").value,fileDict:JSON.stringify(b),md:h,tree:l}).then((function(e){console.log("Document written with ID: ",e.id),B("/Exhibits/".concat(e.id))})).catch((function(e){console.error("Error adding document: ",e)}))}()},id:"create-exhibit",type:"primary"},"Publish")))),function(){if(""!==D)return r.a.createElement(d.a,{to:D,push:!0})}())},he={name:"file",multiple:!0,customRequest:function(e){var t=new FileReader;t.readAsBinaryString(e.file),t.onload=function(t){var a=t.target.result,n="".concat(e.file.name);sessionStorage.setItem(n,a)}},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?U.a.success("".concat(e.file.name," file uploaded successfully")):"error"===e.file.status&&U.a.error("".concat(e.file.name," file upload failed."))}},fe=function(){return r.a.createElement(V.a,he,r.a.createElement(F.a,null,r.a.createElement(q.a,null)," Upload"))},ge=a(775),pe=E.a.TabPane;function be(e){console.log(e)}var Ee=function(){var e=Object(n.useState)({theme:{floor:null,walls:null,ceiling:null},rooms:[{name:"1",artifacts:[]},{name:"2",artifacts:[]}]}),t=Object(c.a)(e,2),a=t[0],l=t[1],i=Object(n.useState)(""),s=Object(c.a)(i,2),u=s[0],m=s[1],h=function(){var e=new ae,t=document.getElementById("editor");console.log("editor value",t);var a=e.parse(t.value);l(a),m(e.cleanedMD)};return Object(n.useEffect)((function(){h()}),[]),r.a.createElement(Z,null,r.a.createElement(Q,{siteTitle:"Playground"}),r.a.createElement("div",{id:"alertstyle"},r.a.createElement(ge.a,{message:"Demo only!",description:"This is a demo editor: museums you create using this tool will not be saved! Please copy your text from the Markdown panel before you close your session.",type:"info",showIcon:!0,closable:!0})),r.a.createElement(z.a,null,r.a.createElement(Y.a,{classname:"gutter-col"},r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"A web editor to view museums written in markdown.",r.a.createElement("br",null),'Create your exhibit in the panel on the left; there\'s a guide detailing the markdown syntax you should use. View your exhibit space in the "Exhibit" tab of panel on the right. The "Document" tab will contain an article of your exhibit instead.',r.a.createElement("br",null),"The editor area in the \"Markdown\" panel contains basic buttons to help you with the markdown syntax. You can click on the H icon to add a header, the link icon to link images, the blockquote icon to add a quote, and so on. In the event that you're using images from the internet in your exhibit via links, make sure that you're using images which are marked for reuse (they'll be blocked by your browser and won't show up, otherwise).")))),r.a.createElement(z.a,null,r.a.createElement(Y.a,{className:"gutter-col",span:12},r.a.createElement("div",{className:"gutter-row",id:"exhibittext"},r.a.createElement(P,{value:"# Hello world! \n\n> Welcome to the world! \n\n## Hello continent \n\nThis is a starter exhibit. Hit build to view it in VR. The name of the museum is Hello world!. There is one room, Hello Continent. There's some wall art about baby elephants and a picture of a baby elephant in a bucket. \n\n> Baby elephants are endangered \n\n![baby elephants are endangered!](https://i.imgur.com/SnolApK.jpg)"})),r.a.createElement("div",{className:"gutter-row"},r.a.createElement(F.a,{onClick:function(){h()},id:"build-exhibit",type:"primary"},"Build")),r.a.createElement("div",{className:"gutter-row",id:"imageupload"},r.a.createElement(fe,null))),r.a.createElement(Y.a,{className:"gutter-col",span:12},r.a.createElement("div",{id:"exhibitmaster"},r.a.createElement("div",{className:"card-container"},r.a.createElement(E.a,{onChange:be,type:"card"},r.a.createElement(pe,{id:"exhibit_pane",tab:"Exhibit",key:"1"},r.a.createElement(se,{exhibitId:"preview",tree:a,b64:!0,editor:!0,debug:!0})),r.a.createElement(pe,{tab:"Document",key:"2"},r.a.createElement(ce,{md:u}))))))),function(){if(o.auth().currentUser&&o.auth().currentUser.email.match(".*berkeley[.]edu"))return r.a.createElement(d.a,{to:"/Editor",push:!0})}())},xe=(a(170),a(771)),ve=function(){var e=Object(n.useState)({theme:{floor:null,walls:null,ceiling:null},rooms:[{name:"1",artifacts:[]},{name:"2",artifacts:[]}]}),t=Object(c.a)(e,2),a=t[0],l=t[1],i=Object(n.useState)(""),o=Object(c.a)(i,2),s=o[0],u=o[1],m=new ae;function d(e,t){return"string"===typeof t?e+t:r.a.Children.toArray(t.props.children).reduce(d,e)}return Object(n.useEffect)((function(){fetch("https://raw.githubusercontent.com/mallocivr/mallocivr.github.io/master/markDown/home.md").then((function(e){return e.text()})).then((function(e){m.parse(e),u(m.cleanedMD),l(m.tree)})).catch((function(e){return console.error(e)}))}),[]),Object(n.useEffect)((function(){document.getElementById("md_article").querySelectorAll("pre code").forEach((function(e){ie.a.highlightBlock(e)}))}),[s]),r.a.createElement(Z,null,r.a.createElement(xe.a,null,r.a.createElement("div",{className:"museum"},r.a.createElement("div",{id:"md_article",className:"museumtext"},r.a.createElement(re.a,{source:s,renderers:{heading:function(e){var t=r.a.Children.toArray(e.children).reduce(d,"").toLowerCase().replace(/[!"#$%&'()*+,-./:;<=>?@[\]^_`{|}~]/g,"").replace(/\W/g,"-");return r.a.createElement("h"+e.level,{id:t},e.children)}}}))),r.a.createElement(se,{exhibitId:"exhibit",tree:a,b64:!1,debug:!0})))},ye=(a(215),a(776)),we=ye.a.Meta,ke=function(){var e=Object(n.useState)([]),t=Object(c.a)(e,2),a=t[0],l=t[1];return Object(n.useEffect)((function(){u.collection("exhibits").get().then((function(e){var t=e.docs.map((function(e){return console.log(e.id," => ",e.data()),r.a.createElement(m.b,{to:"/Exhibits/".concat(e.id)},r.a.createElement(ye.a,{className:"card-space",hoverable:!0,style:{width:300},cover:r.a.createElement("img",{alt:"example",src:e.data().preview})},r.a.createElement(we,{title:e.data().title})))}));l(t)}))}),[]),r.a.createElement(Z,null,r.a.createElement(Q,{siteTitle:"The Malloci Gallery"}),r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"A curation of VR museums generated using Malloci.")),r.a.createElement("div",{className:"mastercard"},a))},Oe=a(780),je=function(){var e=Object(d.g)().exhibit,t=Object(n.useState)({theme:{floor:null,walls:null,ceiling:null},rooms:[{name:"1",artifacts:[]},{name:"2",artifacts:[]}]}),a=Object(c.a)(t,2),l=a[0],i=a[1],s=Object(n.useState)(""),h=Object(c.a)(s,2),f=h[0],g=h[1],p=Object(n.useState)(!1),b=Object(c.a)(p,2),E=b[0],x=b[1];function v(e,t){return"string"===typeof t?e+t:r.a.Children.toArray(t.props.children).reduce(v,e)}return Object(n.useEffect)((function(){u.collection("exhibits").doc(e).get().then((function(e){e.exists?(o.auth().currentUser&&o.auth().currentUser.uid===e.data().authorID&&x(!0),g(e.data().md),i(e.data().tree)):console.log("No such document!")})).catch((function(e){console.log("Error getting document:",e)}))}),[]),Object(n.useEffect)((function(){document.getElementById("md_article").querySelectorAll("pre code").forEach((function(e){ie.a.highlightBlock(e)}))}),[f]),r.a.createElement(Z,null,r.a.createElement(xe.a,null,r.a.createElement("div",{className:"museum"},function(){if(E)return r.a.createElement(m.b,{to:"/Editor/".concat(e)},r.a.createElement(L.a,{title:"Edit This Exhibit"},r.a.createElement(F.a,{type:"default",shape:"circle",icon:r.a.createElement(Oe.a,null)})))}(),r.a.createElement("div",{id:"md_article",className:"museumtext"},r.a.createElement(re.a,{source:f,renderers:{heading:function(e){var t=r.a.Children.toArray(e.children).reduce(v,"").toLowerCase().replace(/[.,\/#!$%\^&\*;:{}=_`~()?]/g,"").replace(/[ \u2019]/g,"-");return r.a.createElement("h"+e.level,{id:t},e.children)},image:function(e){return r.a.createElement("p",null,r.a.createElement("img",e))}}})))),r.a.createElement(se,{exhibitId:"exhibit",tree:l,b64:!1,debug:!0}))},Ie=ye.a.Meta,Se=function(){return r.a.createElement(Z,null,r.a.createElement(Q,{siteTitle:"About us"}),r.a.createElement("div",{className:"description"},r.a.createElement("p",null,"The team behind Malloci")),r.a.createElement("div",{className:"mastercard"},r.a.createElement(ye.a,{className:"card-space",hoverable:!0,style:{width:500},cover:r.a.createElement("img",{alt:"example",src:"https://upload.wikimedia.org/wikipedia/commons/e/e2/Northern_lights_%289997815384%29.jpg"})},r.a.createElement(Ie,{title:"Masha Belyi",description:"NLP Engineer"})),r.a.createElement(ye.a,{className:"card-space",hoverable:!0,style:{width:500},cover:r.a.createElement("img",{alt:"example",src:"https://upload.wikimedia.org/wikipedia/commons/e/e2/Northern_lights_%289997815384%29.jpg"})},r.a.createElement(Ie,{title:"Michael Gutensohn",description:"Product Owner + VR Software Engineer"})),r.a.createElement(ye.a,{className:"card-space",hoverable:!0,style:{width:500},cover:r.a.createElement("img",{alt:"example",src:"https://upload.wikimedia.org/wikipedia/commons/e/e2/Northern_lights_%289997815384%29.jpg"})},r.a.createElement(Ie,{title:"Jennifer Momoh",description:"Quantitative UX Researcher"})),r.a.createElement(ye.a,{className:"card-space",hoverable:!0,style:{width:500},cover:r.a.createElement("img",{alt:"example",src:"https://upload.wikimedia.org/wikipedia/commons/e/e2/Northern_lights_%289997815384%29.jpg"})},r.a.createElement(Ie,{title:"Sharanya Soundararajan",description:"Rabbit"})),r.a.createElement(ye.a,{className:"card-space",hoverable:!0,style:{width:500},cover:r.a.createElement("img",{alt:"example",src:"https://upload.wikimedia.org/wikipedia/commons/e/e2/Northern_lights_%289997815384%29.jpg"})},r.a.createElement(Ie,{title:"Yejun Wu",description:"VR Experience Designer"}))))},Ne=a(766),Te=function(){function e(){Object(ee.a)(this,e),this.api="https://en.wikipedia.org/w/api.php",this.fetchUrl=this.api+"?origin=*&action=parse&prop=text&format=json&page="}return Object(te.a)(e,[{key:"search",value:function(e,t,a){var n={action:"opensearch",list:"search",search:e,format:"json",limit:t},r=this.api+"?origin=*";Object.keys(n).forEach((function(e){r+="&"+e+"="+n[e]})),fetch(r).then((function(e){return e.json()})).then((function(e){a(e)})).catch((function(e){console.log(e)}))}},{key:"parse",value:function(e,t){var a=this;fetch(this.fetchUrl+e).then((function(e){return e.json()})).then((function(e){var n="<body>"+e.parse.text["*"]+"</body>";a.htmlToMd(e.parse.title,n,!1),t(a.md.join("\n\n"))}))}},{key:"parseFull",value:function(e,t){var a=this;fetch(this.fetchUrl+e).then((function(e){return e.json()})).then((function(e){var n="<body>"+e.parse.text["*"]+"</body>";a.htmlToMd(e.parse.title,n,!0),a.waitForImages(10,t)}))}},{key:"page_summary",value:function(e,t){if(null==e)return{};var a="https://en.wikipedia.org/api/rest_v1/page/summary/"+encodeURIComponent(e.replace(/ /g,"_"));fetch(a).then((function(e){return e.json()})).then((function(e){t(e)})).catch((function(e){console.log(e)}))}},{key:"cleanText",value:function(e){return e=(e=(e=e.replace(/ *\[[^\]]*\]/g,"")).replace(/\s+/," ")).replace(/^\s+|\s+$/g,"")}},{key:"htmlToMd",value:function(e,t,a){this.waitForImage=0,this.imgPlaceholder={};var n=["# "+e];this.md=n;for(var r=(new DOMParser).parseFromString(t,"text/xml").getElementsByClassName("mw-parser-output")[0].childNodes,l=0;l<r.length;l++){var i=r[l];if("mw-empty-elt"!=i.className)if("p"==i.nodeName){if(n.push(this.cleanText(i.textContent)),!a)continue;for(var c=i.getElementsByTagName("a"),o=0;o<c.length;o++){var s=c[o],u=s.getAttribute("title");if(!(null==u||"new"==s.className||Math.random()>.3)){var m=n.length;if(!(u in this.imgPlaceholder)){this.imgPlaceholder[u]=m,this.waitForImage++,n.push("~\n!["+u+"](placeholder)\n~");var d=this;this.page_summary(u,(function(e){if("originalimage"in e){var t=e.title;"extract"in e&&(t=(t=e.extract).replace(/([.?!])\s*(?=[A-Z])/g,"$1|").split("|")[0]),d.md[d.imgPlaceholder[e.title]]="~\n!["+t+"]("+e.originalimage.source+")\n~",delete d.imgPlaceholder[e.title]}d.waitForImage--}))}}}}else if(i.nodeName.startsWith("h")){var h=this.cleanText(i.textContent);if("References"==h)break;var f="#".repeat(parseInt(i.nodeName.charAt(1)));n.push(f+" "+h)}else if("div"===i.nodeName&&i.className.includes("thumb"))for(var g=i.getElementsByTagName("img"),p=i.getElementsByClassName("thumbcaption"),b=0;b<g.length;b++){var E=g[b].getAttribute("data-file-width"),x="https:"+g[b].getAttribute("src").replace(/\d+px/,E+"px");n.push("!["+this.cleanText(p[b]?p[b].textContent:"")+"]("+x+")")}else if("ol"==i.nodeName||"ul"==i.nodeName){for(var v="ol"==i.nodeName,y=i.getElementsByTagName("li"),w=[],k=0;k<y.length;k++){var O=v?k+1+".":"*";w.push(O+" "+this.cleanText(y[k].textContent))}n.push(w.join("\n"))}}return n}},{key:"waitForImages",value:function(e,t){var a=this;if(console.log("waiting: "+e),this.waitForImage>0&&e>0)setTimeout((function(){a.waitForImages(e-2,t)}),2e3);else{var n=[];for(var r in this.imgPlaceholder)n.push(this.imgPlaceholder[r]);n.sort((function(e,t){return t-e})),console.log(n);for(var l=0;l<n.length;l++)this.md.splice(n[l],1);t(this.md.join("\n\n"))}}}]),e}(),Ae=function(){var e=Object(n.useState)({theme:{floor:null,walls:null,ceiling:null},rooms:[{name:"1",artifacts:[]},{name:"2",artifacts:[]}]}),t=Object(c.a)(e,2),a=t[0],l=(t[1],Object(n.useState)("")),i=Object(c.a)(l,2),o=i[0],s=(i[1],new Te),u=(new ae,Object(n.useState)("")),m=Object(c.a)(u,2),d=m[0],h=m[1],f=Object(n.useState)([]),b=Object(c.a)(f,2),E=b[0],x=b[1];function v(e,t){return"string"===typeof t?e+t:r.a.Children.toArray(t.props.children).reduce(v,e)}return Object(n.useEffect)((function(){document.getElementById("md_article").querySelectorAll("pre code").forEach((function(e){ie.a.highlightBlock(e)}))}),[o]),r.a.createElement(Z,null,r.a.createElement(xe.a,null,r.a.createElement("div",{className:"museum"},r.a.createElement("div",{id:"md_article",className:"museumtext"},r.a.createElement(Ne.a,{value:d,options:E,style:{width:200},onSelect:function(e){console.log("onSelect",e),s.parseFull(e.replace(/ /g,"_"),function(){var e=Object(p.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},onSearch:function(e){s.search(e,10,(function(e){x(e[1].map((function(e){return{value:e}})))}))},onChange:function(e){h(e)},placeholder:"Search Wikipedia"}),r.a.createElement(re.a,{source:o,renderers:{heading:function(e){var t=r.a.Children.toArray(e.children).reduce(v,"").toLowerCase().replace(/[.,\/#!$%\^&\*;:{}=_`~()?]/g,"").replace(/[ \u2019]/g,"-");return r.a.createElement("h"+e.level,{id:t},e.children)},image:function(e){return r.a.createElement("p",null,r.a.createElement("img",e))}}})))),r.a.createElement(se,{exhibitId:"exhibit",tree:a,b64:!1,debug:!0}))},Ce=function(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),a=t[0],l=t[1],i=Object(n.useState)(!1),s=Object(c.a)(i,2),u=s[0],f=s[1];Object(n.useEffect)((function(){o.auth().onAuthStateChanged((function(e){l(!!e)}))}),[]);return r.a.createElement("div",{id:"navbar"},r.a.createElement("a",{href:"/"},r.a.createElement("img",{src:"./logo192.png",id:"logoformatting"})),r.a.createElement("div",{id:"mallocititle"},r.a.createElement("h2",null,r.a.createElement("a",{href:"/"},"Malloci"))),r.a.createElement(m.a,null,r.a.createElement("div",{id:"menualign"},r.a.createElement(h.a,{mode:"horizontal"},r.a.createElement(h.a.Item,{key:"gallery"},r.a.createElement(m.c,{to:"/"},"Gallery")),r.a.createElement(h.a.Item,{key:"museum"},r.a.createElement(m.c,{to:"/Malloci"},"About Malloci")),r.a.createElement(h.a.Item,{key:"mallocieditor"},a&&o.auth().currentUser.email.match(".*berkeley[.]edu")?r.a.createElement(m.c,{to:"/Editor"},"Editor"):r.a.createElement(m.c,{to:"/Playground"},"Playground")))),r.a.createElement("div",{id:"signInOut"},r.a.createElement(h.a,null,r.a.createElement(h.a.Item,{key:"signin"},a?r.a.createElement("a",{onClick:function(){o.auth().signOut(),f(!0)}},"Sign Out"):r.a.createElement("a",{onClick:function(){!function(){var e=new o.auth.GoogleAuthProvider;o.auth().signInWithPopup(e),f(!1)}()}},"Sign In")))),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/"},r.a.createElement(ke,null)),r.a.createElement(d.b,{exact:!0,path:"/Playground"},r.a.createElement(Ee,null)),r.a.createElement(d.b,{exact:!0,path:"/Editor"},r.a.createElement(de,null)),r.a.createElement(d.b,{exact:!0,path:"/Malloci"},r.a.createElement(ve,null)),r.a.createElement(d.b,{path:"/exhibits/:exhibit"},r.a.createElement(je,null)),r.a.createElement(d.b,{path:"/Editor/:id"},r.a.createElement(de,null)),r.a.createElement(d.b,{exact:!0,path:"/TheTeam"},r.a.createElement(Se,null)),r.a.createElement(d.b,{exact:!0,path:"/WikiViewer"},r.a.createElement(Ae,null))),function(){if(u)return r.a.createElement(d.a,{to:"/",push:!0})}()))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[251,1,2]]]);
//# sourceMappingURL=main.456f6981.chunk.js.map